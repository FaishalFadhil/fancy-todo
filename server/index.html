<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To Do!</title>
</head>
<body>
  <h1>The To Do</h1>
  <div id='forLogin'>
    <form action="" method="post" id='formLogin'>
      <h3>Login</h3>
      <label for="">Email</label><br>
      <input type="email" name="" id="emailLogin"  placeholder="e.g. Ujank@mail.com"><br>
      <label for="">Password</label><br>
      <input type="password" name="" id="passwordLogin" placeholder="min. 8 characters and include number or symbol"><br>
      <input type="submit" value="Login Here!">
    </form>
    <p>Don't have account? Register below!</p>
  </div>
  <div id="forRegister">
    <form action="" method="post" id='formRegister'>
      <h3>Register</h3>
      <label for="">First Name</label><br>
      <input type="text" name="" id="first_name" placeholder="e.g. Ujank"><br>
      <label for="">Last Name</label><br>
      <input type="text" name="" id="last_name"  placeholder="if you aren't fill this, we use your first name as las name"><br>
      <label for="">Email</label><br>
      <input type="email" name="" id="emailRegister"  placeholder="e.g. Ujank@mail.com"><br>
      <label for="">Password</label><br>
      <input type="password" name="" id="passwordRegister" placeholder="min. 8 characters and include number or symbol"><br>
      <input type="submit" value="Submit Here!">
    </form>
  </div>
  <div id="mainPage">
    <div id="toDoForm">
      <form action="" method="post" id="formToDo">
        <label for=""></label>
      </form>
    </div>
  </div>


 
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script>
    function loginPage() {
      $('#forlogin').show()
      $('#forRegister').show()
    }
    function inputRegister() {
      const first_name = $('#first_name').val()
      const last_name = $('#last_name').val()
      const email = $('#emailRegister').val()
      const password = $('#passwordRegister').val()
      $.ajax({
        url:'http://localhost:3000/register',
        method: 'POST',
        data: {
          first_name,
          last_name,
          email,
          password
        }
      })
      .done((Response)=>{
        $('#error').remove()
        $('#success').remove()
        $('#forRegister').append(`<p id='success'>Success adding your account ${Response.first_name}</p>`)
      })
      .fail((xhr, textStatus)=>{
        $('#success').remove()
        $('#error').remove()
        $('#forRegister').append(`<p id='error'>Error: ${xhr.status}</p>`)
      })
      .always(()=>{
        $('#first_name').val('')
        $('#last_name').val('')
        $('#emailRegister').val('')
        $('#passwordRegister').val('')
      })
    }
    function inputLogin() {
      const email = $('#emailLogin').val()
      const password = $('#passwordLogin').val()
      $.ajax({
        url:'http://localhost:3000/login',
        method: 'POST',
        data: {
          email,
          password
        }
      })
      .done((Response)=>{
        $('#success').remove()
        $('#error').remove()
        $('#errorLogin').remove()
        localStorage.setItem('access_token', Response.access_token)
      })
      .fail((xhr, textStatus)=>{
        $('#success').remove()
        $('#error').remove()
        $('#errorLogin').remove()
        $('#forLogin').append(`<p id='errorLogin'>Error: ${xhr.status}</p>`)
      })
      .always(()=>{
        $('#emailLogin').val('')
        $('#passwordLogin').val('')
      })
    }
    
    $(document).ready(function(){
      loginPage()

      $('#formRegister').on('submit', (e)=>{
        inputRegister()
        e.preventDefault()
      })
    })
  </script>
</body>
</html>